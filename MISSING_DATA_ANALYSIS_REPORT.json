{
  "timestamp": "2025-08-07T08:39:26.020Z",
  "connection_status": "success",
  "missing_data_analysis": {
    "spotify_analytics.listening_history": {
      "description": "Complete Spotify listening history",
      "target_collection": "echotune.echotune_listening_history",
      "source_count": 203090,
      "target_count": 0,
      "missing_records": 203090,
      "sample_structure": {
        "total_unique_fields": 10,
        "has_timestamps": true,
        "has_user_data": true,
        "has_track_data": true,
        "has_audio_features": false,
        "has_listening_metrics": true,
        "common_fields": {
          "_id": 3,
          "spotify_track_uri": 3,
          "timestamp": 3,
          "user": 3,
          "track": 3,
          "album": 3,
          "artist": 3,
          "listening": 3,
          "metadata": 3,
          "migration": 3
        },
        "data_quality_score": 75
      },
      "audio_features_potential": 203090,
      "merge_priority": 85
    },
    "spotify_analytics.chat_history": {
      "description": "Chat interaction history",
      "target_collection": "echotune.echotune_chat_sessions",
      "source_count": 33,
      "target_count": 0,
      "missing_records": 33,
      "sample_structure": {
        "total_unique_fields": 7,
        "has_timestamps": true,
        "has_user_data": true,
        "has_track_data": false,
        "has_audio_features": false,
        "has_listening_metrics": false,
        "common_fields": {
          "_id": 3,
          "user_id": 3,
          "session_id": 3,
          "message_type": 3,
          "content": 3,
          "timestamp": 3,
          "metadata": 3
        },
        "data_quality_score": 30
      },
      "audio_features_potential": 0,
      "merge_priority": 28
    },
    "spotify_analytics.chat_sessions": {
      "description": "Chat session data",
      "target_collection": "echotune.echotune_chat_sessions",
      "source_count": 18,
      "target_count": 0,
      "missing_records": 18,
      "sample_structure": {
        "total_unique_fields": 7,
        "has_timestamps": true,
        "has_user_data": true,
        "has_track_data": false,
        "has_audio_features": false,
        "has_listening_metrics": false,
        "common_fields": {
          "_id": 3,
          "user_id": 3,
          "start_time": 3,
          "last_activity": 3,
          "context": 3,
          "metadata": 3,
          "message_count": 3
        },
        "data_quality_score": 30
      },
      "audio_features_potential": 0,
      "merge_priority": 28
    },
    "spotify_analytics.user_profiles": {
      "description": "User preference and profile data",
      "target_collection": "echotune.echotune_user_preferences",
      "source_count": 9,
      "target_count": 0,
      "missing_records": 9,
      "sample_structure": {
        "total_unique_fields": 5,
        "has_timestamps": true,
        "has_user_data": false,
        "has_track_data": false,
        "has_audio_features": false,
        "has_listening_metrics": false,
        "common_fields": {
          "_id": 3,
          "spotify_id": 3,
          "display_name": 3,
          "created_at": 3,
          "preferences": 3
        },
        "data_quality_score": 10
      },
      "audio_features_potential": 0,
      "merge_priority": 16
    }
  },
  "merge_recommendations": [
    {
      "priority": "HIGH",
      "source_collection": "spotify_analytics.listening_history",
      "target_collection": "echotune.echotune_listening_history",
      "missing_records": 203090,
      "merge_strategy": "batch_insert_with_progress_tracking",
      "estimated_time": "15-30 minutes",
      "benefits": [
        "Massive increase in listening history data for recommendations",
        "Enhanced user profiling and personalization",
        "Improved recommendation algorithms with listening patterns",
        "203090 tracks available for audio features enhancement",
        "High-quality structured data for analytics"
      ]
    },
    {
      "priority": "LOW",
      "source_collection": "spotify_analytics.chat_history",
      "target_collection": "echotune.echotune_chat_sessions",
      "missing_records": 33,
      "merge_strategy": "direct_insert_with_validation",
      "estimated_time": "< 1 minute",
      "benefits": [
        "Enhanced user profiling and personalization"
      ]
    },
    {
      "priority": "LOW",
      "source_collection": "spotify_analytics.chat_sessions",
      "target_collection": "echotune.echotune_chat_sessions",
      "missing_records": 18,
      "merge_strategy": "direct_insert_with_validation",
      "estimated_time": "< 1 minute",
      "benefits": [
        "Enhanced user profiling and personalization"
      ]
    },
    {
      "priority": "LOW",
      "source_collection": "spotify_analytics.user_profiles",
      "target_collection": "echotune.echotune_user_preferences",
      "missing_records": 9,
      "merge_strategy": "direct_insert_with_validation",
      "estimated_time": "< 1 minute",
      "benefits": []
    }
  ],
  "data_samples": {
    "spotify_analytics.listening_history": [
      {
        "_id": "spotify:track:3uXR8I4kT1WtvtHTEj4ZHG_willexmen_2010-05-03 09:18:15+00:00",
        "spotify_track_uri": "spotify:track:3uXR8I4kT1WtvtHTEj4ZHG",
        "timestamp": "[Object]",
        "user": "[Object]",
        "track": "[Object]",
        "album": "[Object]",
        "artist": "[Object]",
        "listening": "[Object]",
        "metadata": "[Object]",
        "migration": "[Object]"
      },
      {
        "_id": "spotify:track:737xuDgcxVtGj6ygIbrKk9_willexmen_2010-05-03 09:21:55+00:00",
        "spotify_track_uri": "spotify:track:737xuDgcxVtGj6ygIbrKk9",
        "timestamp": "[Object]",
        "user": "[Object]",
        "track": "[Object]",
        "album": "[Object]",
        "artist": "[Object]",
        "listening": "[Object]",
        "metadata": "[Object]",
        "migration": "[Object]"
      },
      {
        "_id": "spotify:track:2bpEeLW2uLlO7boly7Q8St_willexmen_2010-05-03 09:26:10+00:00",
        "spotify_track_uri": "spotify:track:2bpEeLW2uLlO7boly7Q8St",
        "timestamp": "[Object]",
        "user": "[Object]",
        "track": "[Object]",
        "album": "[Object]",
        "artist": "[Object]",
        "listening": "[Object]",
        "metadata": "[Object]",
        "migration": "[Object]"
      }
    ],
    "spotify_analytics.chat_history": [
      {
        "_id": "988199f3-803c-4f1e-b0aa-c3297a9891f5",
        "user_id": "user_4tl6yaipa",
        "session_id": "07e61efd-7167-490c-b093-a08c0df0e404",
        "message_type": "assistant",
        "content": "I apologize, but I encountered an error while processing your message. Please try again or rephrase ...",
        "timestamp": "[Object]",
        "metadata": "[Object]"
      },
      {
        "_id": "dbfe27b7-fd3e-4d2b-9373-79ad94dcbd8f",
        "user_id": "user_4tl6yaipa",
        "session_id": "ad338281-87e3-4bb4-9a72-2214f1a8e168",
        "message_type": "assistant",
        "content": "I apologize, but I encountered an error while processing your message. Please try again or rephrase ...",
        "timestamp": "[Object]",
        "metadata": "[Object]"
      },
      {
        "_id": "9bd60ac2-83db-4034-9e1f-69cd38342c1d",
        "user_id": "user_1wc0dx5uf",
        "session_id": "059fa9a5-f87d-4f5a-bce8-cc123ca3fa47",
        "message_type": "assistant",
        "content": "I apologize, but I encountered an error while processing your message. Please try again or rephrase ...",
        "timestamp": "[Object]",
        "metadata": "[Object]"
      }
    ],
    "spotify_analytics.chat_sessions": [
      {
        "_id": "2bcd44c3-452a-410a-b7cf-cc209668804b",
        "user_id": "user_solm7ygl5",
        "start_time": "[Object]",
        "last_activity": "[Object]",
        "context": "[Object]",
        "metadata": "[Object]",
        "message_count": 0
      },
      {
        "_id": "07e61efd-7167-490c-b093-a08c0df0e404",
        "user_id": "user_4tl6yaipa",
        "start_time": "[Object]",
        "last_activity": "[Object]",
        "context": "[Object]",
        "metadata": "[Object]",
        "message_count": 0
      },
      {
        "_id": "0ef74c6c-dc43-4f16-86cd-f8de87b3141e",
        "user_id": "user_yfrt3erx7",
        "start_time": "[Object]",
        "last_activity": "[Object]",
        "context": "[Object]",
        "metadata": "[Object]",
        "message_count": 0
      }
    ],
    "spotify_analytics.user_profiles": [
      {
        "_id": "[Object]",
        "spotify_id": "user_solm7ygl5",
        "display_name": "Unknown User",
        "created_at": "[Object]",
        "preferences": "[Object]"
      },
      {
        "_id": "[Object]",
        "spotify_id": "user_4tl6yaipa",
        "display_name": "Unknown User",
        "created_at": "[Object]",
        "preferences": "[Object]"
      },
      {
        "_id": "[Object]",
        "spotify_id": "user_yfrt3erx7",
        "display_name": "Unknown User",
        "created_at": "[Object]",
        "preferences": "[Object]"
      }
    ]
  }
}